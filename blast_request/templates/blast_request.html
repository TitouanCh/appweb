{% extends "base.html" %}
{% block title %}Accéder aux bases de données{% endblock %}
{% block content %}

<h1>Accéder aux informations complémentaires des bases de données</h1>
<form method="post">
    {% csrf_token %}
    <label for="database">Sélectionnez une base de données :</label>
    <select id="database" name="database" required>
        {% for db in databases %}
            <option value="{{ db.id }}">{{ db.name }}</option>
        {% endfor %}
    </select>

    <label for="sequence_id">Sélectionnez une séquence enregistrée :</label>
    <select id="sequence_id" name="sequence_id">
        {% if sequences.exists %}
            <option value="">-- Choisir une séquence locale --</option>
            {% for seq in sequences %}
                <option value="{{ seq.id }}">ID: {{ seq.id }}, Status: {{ seq.status }}, Sequence: {{ seq.sequence|slice:":30" }}...</option>
            {% endfor %}
        {% else %}
            <option value="" disabled>Aucune séquence disponible</option>
        {% endif %}
    </select>

    <label for="sequence">Ou entrez une séquence :</label>
    <textarea id="sequence" name="sequence" rows="5" cols="50" placeholder="Collez votre séquence ici"></textarea>

    <button type="submit">Accéder</button>
</form>

{% if error_message %}
    <p style="color: red;">{{ error_message }}</p>
{% endif %}

{% if redirect_url %}
    <p>Votre séquence a été analysée. <a href="{{ redirect_url }}" target="_blank">Cliquez ici pour accéder à l'outil approprié.</a></p>
{% elif uniprot_sequence %}
    <p>Votre séquence pour UniProt est prête : {{ uniprot_sequence }}</p>
    <p><a href="https://www.uniprot.org/blast/?sequence={{ uniprot_sequence }}" target="_blank">Cliquez ici pour accéder à UniProt.</a></p>
{% endif %}

{% endblock %}
